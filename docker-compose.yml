version: '3.8'
services:
  speakquery:
    build: .
    container_name: speakquery
    env_file:
      - .env
    environment:
      PYCHARM_ATTACH: "${PYCHARM_ATTACH:-0}"
      PYCHARM_DEBUG_HOST: "${PYCHARM_DEBUG_HOST:-host.docker.internal}"
      PYCHARM_DEBUG_PORT: "${PYCHARM_DEBUG_PORT:-5678}"
      PYCHARM_DEBUG_PATCH_MULTIPROCESSING: "${PYCHARM_DEBUG_PATCH_MULTIPROCESSING:-1}"
      PYCHARM_DEBUG_REDIRECT_OUTPUT: "${PYCHARM_DEBUG_REDIRECT_OUTPUT:-0}"
      PYCHARM_DEBUG_SUSPEND: "${PYCHARM_DEBUG_SUSPEND:-0}"
    ports:
      - "5000:5000"
    volumes:
      - ./indexes:/opt/speakquery/indexes
      - ./logs:/opt/speakquery/logs
      - ./lookups:/opt/speakquery/lookups
      - ./executed_scheduled_searches:/opt/speakquery/executed_scheduled_searches
      - ./scheduled_input_scripts:/opt/speakquery/scheduled_input_scripts
      - ./saved_searches.db:/opt/speakquery/saved_searches.db
      - ./saved_search_history.db:/opt/speakquery/saved_search_history.db
      - ./scheduled_inputs.db:/opt/speakquery/scheduled_inputs.db
      - ./scheduled_inputs_history.db:/opt/speakquery/scheduled_inputs_history.db
      - ./history.db:/opt/speakquery/history.db
    restart: unless-stopped
